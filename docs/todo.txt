# Ramses Extras - Improvement / Cleanup TODO

> **Testing reminder:** For every task below, evaluate whether we can add or improve tests for the files we touch to keep increasing coverage.
> **Registry reminder:** Changing registries is delicate; keep changes isolated and avoid touching global registries unless strictly required.



## Status: Next (priority)


## Framework Cleanup (Priority)

 - [ ] **Consolidate validation and calculation helpers**
   - Move `calculate_absolute_humidity` from `framework/helpers/entities.py` to `framework/helpers/common/utils.py`.
   - Remove redundant `validate_humidity_value` and `validate_temperature_value` from `entities.py` (already in `RamsesValidator`).
   - Delete `framework/helpers/entities.py`.
 - [ ] **Remove unused Service Framework components**
   - Remove `ServiceRegistrationManager` from `framework/helpers/service/registration.py`.
   - Remove `ServiceValidator`, `ValidationResult`, and `validate_service_call` from `framework/helpers/service/validation.py`.
 - [ ] **Consolidate sparse modules**
   - Move `_singularize_entity_type` from `framework/helpers/automation/core.py` to `framework/helpers/automation/__init__.py`.
   - Delete `framework/helpers/automation/core.py`.
 - [ ] **Remove unused Config helpers**
   - Delete `framework/helpers/config/schema.py` (unused `ConfigSchema`).

## Sensor control improvements (Later)

 - [ ] **External calculated absolute humidity entities / multi-sensor strategy**
   - Scenario: multiple temp/humidity sensors for one fan (bathroom + kitchen).
   - Desired behaviour:
     - If any zone spikes, ventilate high for N minutes (handshake with automation).
     - Need OR / max logic and a cooldown / decay strategy.
   - Ideas to explore:
     - Add “aggregation strategy” per device (max/avg/weighted) for resolved metrics.
     - Make Humidity Control consume an abstract “effective abs humidity” that can switch sources.


## Developer experience (Later)

 - [ ] **Add an explicit “Framework API surface” doc section**
   - What helpers are stable for features to call (PlatformSetup, CardRegistry, SensorControlResolver, etc.).
 - [ ] **Add a cleanup test**
   - A unit test asserting there are no duplicate registries / unused registries for WS.
